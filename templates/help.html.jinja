{% extends "base.html.jinja" %}

{% block title %}{{ config.html.title_prefix }} – Cell Type Explorer – Help{% endblock %}

{% block header %}{% include "sections/header.html.jinja" %}{% endblock %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="pm-stacked">
        <h1>Help & User Guide</h1>
        <p class="pm-text-secondary">Complete guide to navigating and understanding the neuron type catalog</p>
      </div>
    </div>
  </div>

  {# Table of Contents #}
  <div class="row">
    <div class="col-xs-12 col-md-3">
      <h3 class="pm-no-margin">Contents</h3>
      <ul class="pm-no-margin">
        <li>
          <a href="#overview">Overview</a>
          <ul>
            <li><a href="#dataset-version">Dataset and Version</a></li>
          </ul>
        </li>
        <li>
          <a href="#types-page">Types Index Page</a>
          <ul>
            <li><a href="#filters">Using Filters</a></li>
            <li><a href="#tags">Legend: Tags and Badges</a></li>
            <li><a href="#filter-reset">Reset and Combining Filters</a></li>
            <li><a href="#search">Search Functionality</a></li>
          </ul>
        </li>
        <li>
          <a href="#neuron-page">Individual Neuron Pages</a>
          <ul>
            <li><a href="#header-info">Header Information</a></li>
            <li><a href="#summary-stats">Summary Statistics</a></li>
            <li><a href="#layer-column-coverage">Layer and Column Coverage</a></li>
            <li><a href="#neuron-visualization">Neuron Visualization</a></li>
            <li><a href="#roi-innervation">ROI Innervation</a></li>
            <li><a href="#s-c">Connectivity</a></li>
          </ul>
        </li>
        <li><a href="#terminology">Terminology</a></li>
        <li><a href="#faq">FAQ and Troubleshooting</a></li>
        <li><a href="#contact">Contact and Feedback</a></li>
      </ul>
    </div>

    <div class="col-xs-12 col-md-9">
      <div>
        {# Overview #}
        <section id="overview" class="pm-stacked">
          <h2>Overview</h2>
          <p>
            This neuron type catalog provides comprehensive information about neurons in the
            <strong>{{ config.neuprint.dataset }}</strong> dataset. The catalog includes detailed morphological,
            connectivity, and functional data for each neuron type, organized into an easy-to-navigate interface.
          </p>
          <blockquote>
            <strong>Quick Start:</strong> Use the <a href="types.html">Types Index</a> to browse all available neuron
            types, or use the search bar in the header to quickly find specific neurons.
          </blockquote>

          <section id="dataset-version" class="pm-stacked">
            <h3>Dataset and Version</h3>
            <p>
              This site is connected to neuPrint at
              <a href="https://{{- config.neuprint.server -}}/?dataset={{- config.neuprint.dataset -}}" target="_blank"
                >https://{{ config.neuprint.server }}</a
              >
              using the <strong>{{ config.neuprint.dataset }}</strong> dataset.
            </p>
          </section>
        </section>

        <hr />

        {# Types Page #}
        <section id="types-page" class="pm-stacked">
          <h2>Types Index Page</h2>
          <p>
            The <a href="types.html">main index page</a> shows all available neuron types with filtering and search capabilities. Dropdown and
            text input fields are placed at the top of the page, followed by "cards" that represent a neuron type.
          </p>
          <p>
            The filters correspond to the tag badges shown on each neuron card. Selecting a value in a dropdown filters
            the list accordingly.
          </p>

          <img src="static/images/types_page_filter50.gif" width="100%" alt="How to use the types filters.">

          {# Using Filters #}
          <div id="filters" class="pm-stacked">
            <h3>Using Filters</h3>
            <p>
              Each dropdown is single‑select. You can combine multiple different filters to further narrow the list;
              results satisfy all selected filters (AND logic) however each individual filter allows only one selection at a time.
            </p>
            <p>
              For example, selecting "Glutamate" in the Neurotransmitter filter shows only neuron types that use
              glutamate as their primary neurotransmitter (defined in the neuPrint database). Additionally selecting "ME" in the ROI filter
              further narrows the list to neuron types with synapses in the Medulla.

            </p>

            <blockquote>
              <strong>Tip:</strong> Many tags are clickable and will filter the list to show related neuron types.
            </blockquote>

            <h4>ROI Filter</h4>
            <p>
              Filter by ROIs where neurons have synapses. ROIs represent brain regions; neurons are considered to be
              part of an ROI if they have synapses within it.
            </p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="roi-tag">ME</span>
                <strong>ROI:</strong> Brain regions such as Medulla, Calyx, or superior lateral protocerebrum.
              </p>
            </div>

            <blockquote>
              <strong>Tip:</strong>  See the neuPrint <a href="https://{{ config.neuprint.server }}/help/brainregions?dataset={{ config.neuprint.dataset }}&qt=findneurons">help page</a>
                for a detailed list of ROIs within the database and their parent regions.
            </blockquote>

            <h4>NT (Neurotransmitter) Filter</h4>
            <p>Filter by the primary neurotransmitter used by the neurons:</p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="nt-tag">Acetylcholine</span>
                <strong>Neurotransmitter Tags:</strong> Primary neurotransmitter used by the neurons.
              </p>
            </div>

            <h4>Dimorphism Filter</h4>
            <p>
              The CNS dataset is based on a male fruit fly. This filter allows selection of neurons that are potentially
              sexually dimorphic.
            </p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="dimorphism-tag">Sex-specific</span>
                <strong>Dimorphism Tags:</strong> Indicates sex-specific or dimorphic characteristics.
              </p>
            </div>

            <h4>Synonyms</h4>
            <p>
              Two types of synonyms can appear on neuron cards. Use the search field to find neurons by their synonyms
              (see Search below). Clicking a synonym tag highlights neuron types that also have that type of synonym.
            </p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="synonym-tag">Published Synonyms</span>
                <strong>Published Synonyms:</strong> Alternative names or aliases from the literature. See the neuron’s
                page for details on sources.
              </p>
            </div>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="flywire-type-tag">FlyWire Synonym</span>
                <strong>FlyWire Type:</strong> Corresponding identifier(s) in the FlyWire dataset.
              </p>
            </div>

            <h4>Side Filter</h4>
            <p>
              Two lateral classifications are considered for the side assignment in the dataset. One considers the location of the soma relative to the midline (`somaSide`). If the soma is missing from the reconstruction, the dendritic arbors can be used to determine the side (`rootSide`). In both cases, the majority of neurons are either considered "left" or "right", with a smaller subset classified as "middle". If a
              neuron is not assigned in the dataset, we classify it as "undefined".
            </p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="view-indicator right">Right</span>,
                <span class="view-indicator left">Left</span>,
                <span class="view-indicator middle">Middle</span>, and
                <span class="view-indicator undefined">Undefined</span> are possible values for the soma side. These
                badges and colors are used consistently across the site.
              </p>
            </div>

            <h4>Superclass Filter</h4>
            <p>
              A high-level functional classification defined in the neuPrint database, such as
              <strong>Optic Lobe Intrinsic</strong>, <strong>Ascending Neuron</strong>, or <strong>VNC Motor</strong>.
            </p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="class-tag superclass-tag">Visual</span>
                <strong>Superclass Tags:</strong> High-level functional classification.
              </p>
            </div>

            <h4>Class Filter</h4>
            <p>Part of the same hierarchy; class groups neuron types into more specific functional groups.</p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="class-tag">Photoreceptor</span>
                <strong>Class Tags:</strong> More specific functional classification within a superclass.
              </p>
            </div>

            <h4>Subclass Filter</h4>
            <p>The most specific functional level in the hierarchy.</p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="class-tag subclass-tag">mechanosensory bristle</span>
                <strong>Subclass Tags:</strong> Finest level of functional classification.
              </p>
            </div>

            <h4>Region Filter and Tags</h4>
            <p>
              Region is a broader anatomical grouping that includes multiple ROIs. The hierarchy of ROIs and their
              assignment to regions are defined in the neuPrint database. Neurons are assigned to all regions in which they have synapses.
            </p>

            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="roi-tag parent-roi">Optic</span>
                <strong>Region:</strong> Anatomical regions such as Optic, Central Brain, Ventral Nerve Cord (VNC) or Cervical Connective (CV).
              </p>
            </div>

            <h4>Cell Count Filter</h4>
            <p>Filter by the number of individual neurons of each type. Counts are grouped for larger values.</p>
            <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="neuron-count-tag">42</span>
                <strong>Neuron Count Tags:</strong> Show the number of individual neurons of this type.
              </p>
            </div>

            <h4>Soma Neuromere</h4>
              <p>Segemental organizational unit of the fly's ventral nerve cord (VNC) based
             on the position of the neuronal somas.</p>
              <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="soma-neuromere-tag">A1</span>
                <strong>Soma Neuromere:</strong> Segemental units such as A1, CB and T2.
              </p>
              </div>

            <h4>Truman Hemilineage</h4>
              <p>Groups of related neurons in the central nervous system (CNS)
              of the fruit fly (<i>Drosophila</i>), identified and categorized based on their developmental origin.</p>
              <div class="pm-stacked pm-bg-light pm-padded">
              <p>
                <span class="truman-hl-tag">01B</span>
                <strong>Truman Hemilineage:</strong> Developmental groups such as 01B, 04A and 21X.
              </p>
              </div>

            <div id="tags" class="pm-stacked">
              <h4><strong>Legend:</strong> Tags and Badges</h4>
              <ul class="pm-stacked">
                <li>
                  Hemisphere variants:
                  <span class="soma-button soma-button-left">L</span>
                  <span class="soma-button soma-button-right">R</span>
                  <span class="soma-button soma-button-middle">M</span>
                  <span class="soma-button soma-button-combined">C</span>
                </li>
                <li>Region: <span class="roi-tag parent-roi">Optic</span></li>
                <li>ROI: <span class="roi-tag">ME</span></li>
                <li>Superclass: <span class="class-tag superclass-tag">ol_intrinsic</span></li>
                <li>Class: <span class="class-tag">visual</span></li>
                <li>Subclass: <span class="class-tag subclass-tag">mechanosensory bristle</span></li>
                <li>Neurotransmitter: <span class="nt-tag">Acetylcholine</span></li>
                <li>Dimorphism: <span class="dimorphism-tag">male-specific</span></li>
                <li>Neuron count: <span class="neuron-count-tag">42</span></li>
                <li>Soma Neuromere: <span class="soma-neuromere-tag">A1</span></li>
                <li>Truman Hemilineage: <span class="truman-hl-tag">01B</span></li>
                <li>
                  Synonyms:
                  <span class="synonym-tag">Published Synonyms</span>,
                  <span class="flywire-type-tag">FlyWire Synonym</span>
                </li>
              </ul>
              <p class="pm-text-secondary">These badges and colors are used consistently across the site.</p>
            </div>

            <div id="filter-reset" class="pm-stacked">
              <h4>Reset and Combining Filters</h4>
              <p>
                Each dropdown is single‑select. You can combine multiple different filters; results satisfy all selected
                filters (AND logic).
              </p>
              <p>Unclick a tag to remove a single filter, clear the selections in the dropdowns or
              click the 'Reset all filters' button to reset the search criteria.</p>
            </div>

            <img src="static/images/reset_filters50.gif" width="100%" alt="How to reset the filters on the types page.">

            <h4 id="search">Search Functionality</h4>
            <p>
              The search bar in the header supports type‑ahead suggestions and is case‑insensitive. Start typing a
              neuron name to see matches. Results may include hemisphere variants (L/R/M/C). Search also matches known
              synonyms as well as the cell type's corresponding name in the FlyWire Female Adult Fly Brain (FAFB) dataset.
              You can explore this dataset in <a href="https://{{ config.neuprint.server }}/?dataset=flywire-fafb%3Av783b&qt=findneurons">neuPrint </a>,
               the <a href="https://codex.flywire.ai/">FlyWire Codex</a> or our corresponding
              <a href="https://reiserlab.github.io/celltype-explorer-drosophila-female-adult-fly-brain/">FAFB Cell Type Explorer </a>.
            </p>
          </div>
        </section>

        <hr />

        {# Individual Neuron Pages #}
        <section id="neuron-page" class="pm-stacked">
          <h2>Individual Neuron Pages</h2>
          <p>
            Each neuron type has dedicated pages with comprehensive analysis and visualizations. Depending on the type
            and its hemisphere variants, neuron types may have a page for neurons whose soma is located in the right
            hemisphere (<span class="soma-button soma-button-right soma-button-current">R</span>), left hemisphere
            (<span class="soma-button soma-button-left soma-button-current">L</span>), or considered to be in the middle
            (<span class="soma-button soma-button-middle soma-button-current">M</span>). If the neuron type has
            instances with more than one side, there is also a combined page for all neurons of that type
            (<span class="soma-button soma-button-combined soma-button-current">C</span>). Use the buttons on the left
            side of the page or the menu (☰) to switch between views.
          </p>

          {# Header Info #}
          <div id="header-info" class="pm-stacked">
            <h3>Header Information</h3>
            <p>
              The header shows the neuron type, the currently selected hemisphere variant as well as well as any associated synonyms.
            </p>
            <p>
              Clicking on the link icon will take you to the relevant neurons' page in the neuPrint database for further exploration.
            </p>
          </div>

          {# Summary Stats #}
          <div id="summary-stats" class="pm-stacked">
            <h3>Summary Statistics</h3>
            <p>The summary section provides key quantitative information:</p>

            <h4>Neurons</h4>
            <p>
              The number of individual neurons of this type in the dataset. For bilateral neurons, counts per hemisphere and ratios may
              be shown across hemispheres.
            </p>

            <h4>Synapses</h4>
            <p>Combined post-synaptic (inputs) and pre-synaptic (outputs), with breakdowns and log ratios where applicable. Technically, this number is a pre-calculated property for each neuron inside the neuprint database.<br/>
            For combined pages the breakdown shows the number of neurons assigned to each hemisphere and their ratio.
            Whereas for unilateral pages the breakdown shows the number of post and pre synapses across all neurons of the type assigned to that side.</p>

            <h4>Connections</h4>
            <p>
              Combined upstream and downstream connections. Here, connections are the number of anatomical synapses between neurons. Technically, this number comes from the number of connected <em>synapse</em>s, which are combined to <em>SynapseSet</em>s and part of <em>Neuron</em>s inside the neuprint database.<br/>
              For combined pages the breakdown shows the number of neurons assigned to each hemisphere and their ratio.
              Whereas for unilateral pages the breakdown shows the number of upstream and downstream connections across all neurons of the type assigned to that side.
            </p>

            <h4>Neurotransmitter</h4>
            <p>
              Predicted neurotransmitter for the type and the corresponding confidence level (CL).
              For some types, the predicted neurotransmitter may be <em>Unc</em> for unclear.
            </p>

            <h4>Synapses per Neuron</h4>
            <p>Average number of synapses per neuron of this type. Useful for comparing connectivity levels.<br/>
            For the combined page, the breakdown shows the mean number of synapses for neurons on the right and left.
            Whereas for unilateral pages the breakdown shows the mean number of pre and post synapses per neuron assigned to that side.</p>

            <h4>Connections per Neuron</h4>
            <p>Average number of connections per neuron of this type. Useful for comparing connectivity levels.<br/>
            For the combined page, the breakdown shows the mean number of connections for neurons on the right and left.
            Whereas for unilateral pages the breakdown shows the mean number of pre and post connections per neuron assigned to that side.</p>

            <h4>Log Ratios</h4>
            <p>
              Log ratios (<i>ld</i>, base <i>2</i>) indicate balance across hemispheres and inputs/outputs; values below 0 favor right/inputs and
              values above 0 favor left/outputs.
            </p>

          </div>

          {# Columnar Layer and Spatial Coverage (Eye Maps) #}
          <div id="layer-column-coverage" class="pm-stacked">
            <h3>Layer and Column Coverage</h3>
            <p><em>Note: These views are only present for visual system neuron types with columnar organization.</em></p>
            <p>Detailed analysis of neuron distribution across layers in visual system neuropils. This section explains how to interpret the “Mean Synapse Count per Layer” tables shown on individual neuron type pages (e.g., Tm3).</p>

            <h4>Mean Synapse Count per Layer</h4>
            <ul>
              <li><strong>Layer names and anatomical locations:</strong> Lamina (LA),
             Medulla (ME), Lobula (LO), Accessory Medulla (AME), Lobula Plate (LOP) and Central Brain (CB). </li>
              <li><strong>Synapse counts:</strong>
              The values show the average number of pre and post synapses within that layer ROI per neuron of the type.
              Counts are aggregated from annotated synapse locations using standardized layer definitions for each
              neuropil.<sub>1</sub></li>
              <li><strong>Input vs. output balance per layer:</strong> Represented by the yellow (input) and blue (output) bars.</li>
              <li>Please note that these tables display synapse counts only for the <strong>ipsilateral</strong>
              optic lobe regions — that is, the lobe on the same side as the soma. For example, the “Tm3_R” page shows
              synapses of Tm3_R neurons within the right optic lobe. Consequently, neuron types that project
              exclusively to the <strong>contralateral</strong> optic lobe (e.g., DNc02) do not have layer tables.
              For <strong>bilateral</strong> neuron types (e.g., MeVPMe13), which innervate both optic lobes,
              the tables include only the counts for the ipsilateral synapses.</li>
            </ul>

            <h4>Population Spatial Coverage</h4>
            <p><em>Note: These Population Spatial Coverage maps are only present for visual system neuron types with columnar organization.</em></p>
            <p>This section visualizes how a neuron type covers the columnar structure of visual system regions using interactive hexagonal grids.</p>
            <p>The plots show the neural innervation of the <strong>ipsilateral</strong> medulla (ME), lobula (LO) and lobula plate (LOP).
            <ul>
              <li><strong>Column Analysis:</strong> Which columns within the ROI the neurons innervate.</li>
              <li><strong>Regional Breakdown:</strong> Separate views for different regions (e.g., ME, LO, LOP)</li>
              <li><strong>Color Coding:</strong> Intensity reflects connection strength or neuron density.</li>
              <li><strong>Interactive Features:</strong> Hover over for details about the hexagonal column coordinate and cell or synapse count.</li>
            </ul>

            <img src="static/images/eyemap_demo.gif" width="50%" alt="Interactivity of the hexagonal eyemap plots." style="display: block; margin-left: auto; margin-right: auto;">
          </div>

          {# Neuron Visualization #}
          <div id="neuron-visualization" class="pm-stacked">
            <h3>Neuron Visualization</h3>
            <p>Interactive 3D visualization of neuron morphology using the embedded Neuroglancer viewer:</p>

            <h4>Viewing the 3D Model</h4>
            <ul>
              <li><strong>Rotate:</strong> Left mouse buttom + drag. (Mac trackpad: click + drag.)</li>
              <li><strong>Translate:</strong> Left mouse buttom + Shift + drag. (Mac trackpad: click + shift + drag.)</li>
              <li><strong>Zoom:</strong> Ctrl + Mouse wheel (Mac trackpad: two finger pinch gestures)</li>
              <li><strong>Select:</strong> Click on neurons to highlight and inspect</li>
              <li><strong>Layers:</strong> Toggle reference layers on/off (as available).
              For example, the video below shows how you can use the "synapses" layer to view the synapses of the visible neurons.</li>
            </ul>

            <img src="static/images/add_synapses_to_NG50.gif" width="80%" alt="How to toggle reference layers in neuroglancer view." style="display: block; margin-left: auto; margin-right: auto;">

            <h4>Keyboard shortcuts</h4>
            <ul>
              <li><strong>z</strong> - Reset to the closest axis.</li>
              <li><strong>o</strong> - Toggle between orthographic and perspective projection.</li>
              <li><strong>l</strong> - Reassign random colors to neurons and ROI meshes.</li>
            </ul>
            <div id="adding-rois">
            <h4>Adding ROI meshes from the ROI table</h4></div>
            <p>
              ROI meshes can be added to the neuroglancer view by selecting the blue checkbox within the ROI table.
              ROIs without checkboxes represent the few VNC ROIs that are currently unavailable to view within neuroglancer.
            </p>

            <img src="static/images/add_roi_ME50.gif" width="80%" alt="How to add ROI meshes to neuroglancer view." style="display: block; margin-left: auto; margin-right: auto;">

            <div id="adding-connected-neurons">
            <h4>Adding Partners from the Connectivity table</h4></div>
            <p>
              You can add connected partners to the 3D view directly from the Connectivity tables by selecting their
              blue checkboxes (see Connectivity section below). Some connected cell types have filled pink checkboxes because there
              are no neurons of that type that directly innervate the example neuron visible by default in the neuroglancer view.
              A random neuron of that type can be added by searching for the type in the search box within the neuroglancer view and adding it manually.
            </p>

            <img src="static/images/add_connected_cells50.gif" width="80%" alt="How to add connected cells to neuroglancer view." style="display: block; margin-left: auto; margin-right: auto;">

            <br>
            <h4>External neuPrint Link</h4>
            <p>
              Direct link to view the same neurons in the full neuPrint interface for advanced analysis is provided on
              the page.
            </p>
          </div>

          {# ROI Innervation #}
          <div id="roi-innervation" class="pm-stacked">
            <h3>ROI Innervation</h3>
            <p>Detailed breakdown of connectivity within specific brain regions:</p>
            <ul>
              <li><strong>Synapse Counts:</strong> Number of inputs and outputs in each ROI.</li>
              <li><strong>Percentage Breakdown:</strong> Relative distribution across regions.</li>
              <li><strong>Log Ratio:</strong> <i>Ld</i> (base 2) of inputs and outputs.
              Negative values indicate more inputs than outputs in that region. Positive values indicate more outputs than inputs.</li>
            </ul>
          </div>

          {# Connectivity #}
          <div id="s-c" class="pm-stacked">
            <h3>Connectivity</h3>
            <p>Comprehensive analysis of synaptic connections with other neuron types:</p>
            <ul>
              <li><strong>Upstream Partners:</strong> Neurons that provide input (pre-synaptic partners)</li>
              <li><strong>Downstream Partners:</strong> Neurons that receive output (post-synaptic partners)</li>
              <li><strong>Number of connected partner:</strong> The celltype count of the connected partners. Note: This is not the number of neurons of that type that act as upstream or downstream partners.</li>
              <li><strong>Number of connections per neuron:</strong> Number of synaptic connections per target neuron.</li>
              <li><strong>Percentage Contribution:</strong> Percentage of total synaptic connections to/from the target type.</li>
               <li><strong>CV:</strong> Coefficient of variation for the number of connections per neuron.</li>
            </ul>
          </div>

          <div id="interactive-table-features" class="pm-stacked">
          <h3>Interactive Table Features</h3>
          <p>Both the ROI and Connectivity tables have a number of interactive features:</p>
            <ul>
              <li><strong>Sort:</strong> Sort the table by a particular column by clicking on the column header.</li>
                <img src="static/images/sort_table_column50.gif" width="99.5%" alt="Sort table by column." style="display: block; margin-left: auto; margin-right: auto;">
              <br>
              <li><strong>Filter:</strong> Filter the table based on the percentage of input or output synapses within
               the region for the ROI table or the minimum number of connections per individual neuron of the target type
                for the connectivity table using the slider in the top right.<br>
               By default, the ROI table is filtered to show only the ROIs with at least <strong>1.5%</strong> of all synapses and the
                connectivity tables to show types with at least <strong>one connection</strong> per neuron of the target type.</li>

              <img src="static/images/filter_table_slider50.gif" width="100%" alt="Filter table with slider." style="display: block; margin-left: auto; margin-right: auto;">

              <br>
              <li><strong>Search:</strong> Search the table for a given string or number using the search box in the top left.</li>

              <img src="static/images/search_table50.gif" width="100%" alt="Search table." style="display: block; margin-left: auto; margin-right: auto;">

              <br>
              <li><strong>Add meshes to the neuroglancer view:</strong> Click on the checkboxes to add either ROI meshes or
              a connected neuron of that type to the neuroglancer visualisation.
              See the adding connected <a href="#adding-connected-neurons">partners</a> or adding <a href="#adding-rois">ROIs</a>
               section to learn more.</li>

              <li><strong>Jump to connected pages:</strong> Click on the partner type's name within the
              connectivity table to take you to that type's page.</li>
          </div>

          <div id="interactive-table-features" class="pm-stacked"></div>
          <h4>Checkboxes and Neuroglancer Integration</h4>
            <ul>
              <li>Each partner row has a checkbox.</li>
              <li>
                <strong>Blue (selected):</strong> adds one example of that partner neuron type to the Neuroglancer view.
              </li>
              <li>
                <strong>Red:</strong> the currently visualized neuron of the active neuron type does not have a
                connecting partner of that partner type in the current context.
              </li>
              <li>
                <strong>Gray (disabled):</strong> partner type matches the current neuron type and would add the same
                neuron instance already visible in the viewer (self-reference prevented).
              </li>
            </ul>
            <p>Use these checkboxes to quickly visualize specific partners together with the current neuron in 3D.
            Disabled checkboxes prevent redundant visualization of the same neuron instances.</p>

        </section>

        <hr />

        {# Terminology #}
        <section id="terminology" class="pm-stacked">
          <h2>Terminology</h2>
          <p>Key terms and concepts used throughout the catalog:</p>

          <dl class="pm-stacked">
            <dt>ROI (Region of Interest)</dt>
            <dd>Anatomically defined brain regions used to organize and analyze neural structures.</dd>

            <dt>Region</dt>
            <dd>A broader anatomical grouping that includes multiple ROIs.</dd>

            <dt>Side</dt>
            <dd>
              The hemisphere or location where the neuron's soma or root is located (Left, Right, Middle, or Undefined).
            </dd>

            <dt>Pre-synaptic / Post-synaptic</dt>
            <dd>
                Post-synaptic refers to inputs to a neuron, pre-synaptic refers to outputs from a neuron.
            </dd>

            <dt>Synapse Count</dt>
            <dd>The number of synaptic connections. Higher counts indicate stronger or denser connectivity. neuView uses the properties from the neurons in the database.</dd>

            <dt>Post-synaptic Sites</dt>
            <dd>Postsynaptic receptor sites where a neuron receives inputs from presynaptic partners. In the data model, this is the `Neuron.post` property.</dd>

            <dt>Pre-synaptic Sites (T-bars)</dt>
            <dd>Presynaptic release sites where a neuron outputs signals. Also called t-bars. One presynaptic site can connect to multiple postsynaptic partners. In the neuprint data model, this is the `Neuron.pre` property.</dd>

            <dt>Connections</dt>
            <dd>Input connections are conceptually similar to post-synaptic sites while a group of post-synaptic sites form a single output connection. We calculate the number of connections by identifying the connecting neurons and then use the `weight` property from the `ConnectsTo` edge between the neurons.</dd>

            <dt>Connections vs. Synapses</dt>
            <dd>The numeric difference between post-synaptic sites and input connections stems from the difference in how the numbers are retrieves (see Synapse Count and Connections above). A single presynaptic site (t-bar) can form multiple connections to different postsynaptic partners. Therefore, the number of output connections can be greater than the number of presynaptic sites.</dd>

            <dt>Inputs</dt>
            <dd>All pre-synaptic connecting cell types upstream from a given cell type (neurons providing input to the cell type).</dd>

            <dt>Outputs</dt>
            <dd>All post-synaptic connecting cell types downstream from a given cell type (neurons receiving output from the cell type).</dd>

            <dt>Log Ratio</dt>
            <dd>
              A logarithmic ratio (<i>ld</i>, logarithm dualis, base <i>2</i>) used to quantify balance between two values (e.g., left vs. right hemisphere, inputs
              vs. outputs).
            </dd>

            <dt>Neurotransmitter (NT)</dt>
            <dd>Chemical messenger used by neurons to communicate across synapses.</dd>

            <dt>Cell Type Classification</dt>
            <dd>Hierarchy: Superclass → Class → Subclass, representing increasingly specific functional categories.
            This hierarchy is from Schlegel et al. 2024<sup>2</sup></dd>

            <dt>FlyWire</dt>
            <dd>Complementary dataset providing additional neuron identification and analysis.</dd>

            <dt>neuPrint</dt>
            <dd>The database and analysis platform containing the connectome data.</dd>

            <dt>Hemisphere variants (L/R/M/C)</dt>
            <dd>Pages can show Left (L), Right (R), Middle (M), or Combined (C) variants of a neuron type.</dd>

            <dt>Bilateral</dt>
            <dd>A neuron type with instances on both the left and right sides.</dd>

            <dt>Column / Ommatidium</dt>
            <dd>
              Repeated retinotopic units in the visual system referenced by column analyses and eye map visualizations.
            </dd>

            <dt>Retinotopy</dt>
            <dd>Mapping between positions in visual space and their representation on neural tissue.</dd>

            <dt>Truman Hemilineage</dt>
            <dd>A Truman hemilineage is a group of related neurons in the central nervous system (CNS)
            of the fruit fly (Drosophila), identified and categorized based on their developmental origin.</dd>

            <dt>Soma Neuromere</dt>
            <dd>The underlying segmental organization of the fly's ventral nerve cord (VNC) based
             on the position of the neuronal somas.</dd>
          </dl>
        </section>

        <hr />

        {# FAQ and Troubleshooting #}
        <section id="faq" class="pm-stacked">
          <h2>FAQ and Troubleshooting</h2>
          <dl class="pm-stacked">
            <dt>Why do some pages show “Middle” side?</dt>
            <dd>
              This is really a question for contributors to the neuPrint database. We observe three different "sides": right, left, and middle and report these assignment in the catalog. We classify neurons that are not assigned to one of these three "sides", as "undefined".
            </dd>

            <dt>Why don’t counts match neuPrint exactly?</dt>
            <dd>
              Differences in filters, dataset updates, or aggregation methods can lead to small discrepancies between
              this catalog and neuPrint.
            </dd>

            <dt>Why are some analyses unavailable for certain neuron types?</dt>
            <dd>
              Some analyses require sufficient morphology or annotation data; when unavailable, the section may be
              limited or omitted.
            </dd>
          </dl>
        </section>

        <hr />

        <section id="references" class="pm-stacked">
          <h2>References</h2>
          <ul>
            <li> <strong>1</strong>
            <cite>Nern, A., Loesche, F., Takemura, Sy. et al. Connectome-driven neural inventory of a complete
             visual system. Nature 641, 1225–1237 (2025). <a href="https://doi.org/10.1038/s41586-025-08746-0">https://doi.org/10.1038/s41586-025-08746-0</a>
            </cite></li>

            <li> <strong>2</strong>
            <cite>Schlegel, P., Yin, Y., Bates, A.S. et al. Whole-brain annotation and multi-connectome
             cell typing of Drosophila. Nature 634, 139–152 (2024). <a href="https://doi.org/10.1038/s41586-024-07686-5">https://doi.org/10.1038/s41586-024-07686-5</a>
            </cite></li>
          </ul>
        </section>

        {# Contact and Feedback #}
        <section id="contact" class="pm-stacked">
          <h2>Contact and Feedback</h2>
          <p>
            {% if config.html.github_repo %}
            Found an issue or have a suggestion? Please open an issue on the
            <a
              href="{{ config.html.github_repo }}"
              target="_blank"
              >project repository</a
            >.
            {% else %}
            Found an issue or have a suggestion? Please contact the development team.
            {% endif %}
          </p>
        </section>

        {# Footer #}
        <div class="pm-stacked">
          <hr />
          <blockquote>
            <strong>Need More Help?</strong>
            Visit the
            <a
              href="https://{{- config.neuprint.server -}}/?dataset={{- config.neuprint.dataset -}}"
              target="_blank"
              >neuPrint database</a
            >
            for advanced analysis tools{% if config.html.github_repo %}, or check the
            <a
              href="{{ config.html.github_repo }}"
              target="_blank"
              >project repository</a
            >
            for additional resources and documentation{% endif %}.
            for technical documentation.
          </blockquote>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block footer %}
{% include "sections/footer.html.jinja" %}
{% endblock %}

{% block extra_scripts %}
{% include "sections/global_scripts.html.jinja" %}
{% endblock %}
